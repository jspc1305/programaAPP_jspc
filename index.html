<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DidacticApp v0.1</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .editable-title {
            border: none;
            background-color: transparent;
            font-size: 1rem;
            max-width: 150px;
        }
        .editable-title:focus {
            outline: none;
            border-bottom: 1px solid #000;
        }
        .problem-group {
            margin-bottom: 10px;
        }
        .situacion-group {
            display: flex;
            flex-direction: column;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            position: relative;
        }
        .situacion-group textarea {
            flex-basis: 100%;
        }
        .situacion-group .problem-group {
            flex-basis: 100%;
        }
        .situacion-group .controls {
            display: flex;
            justify-content: flex-start;
        }
        .btn-eliminar-situacion {
            position: absolute;
            top: -10px;
            right: -10px;
        }
        .controls {
            margin-top: 10px;
        }
        hr {
            border-top: 2px solid #000;
        }
        footer {
            height: 150px; /* Pie de página amplio */
            background-color: #f8f9fa;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
        }
        #faseSection {
            display: none;
        }
        .row-matrix {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .row-matrix .col {
            flex: 1;
            padding: 5px;
        }
        .add-row-btn, .remove-row-btn {
            margin-left: 10px;
        }
        .header-row {
            font-weight: bold;
            text-align: center;
            margin-bottom: 15px;
        }
        .textarea-evidencia {
            height: 100px;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h2>DidacticApp v0.1</h2>

        <!-- Sección principal -->
        <div id="mainSection">
            <hr>
            <h4>PLANO DE LA REALIDAD. PROBLEMATIZACIÓN</h4>
            <div class="row mb-4">
                <div class="col-md-12">
                    <h6>Descripción del Tema</h6>
                    <textarea class="form-control" id="descripcionTema" rows="3" placeholder="Son elementos que facilitan la descripción del tema, por ejemplo: Datos estadísticos; descripción del lugar, la escena, las situaciones, datos específicos con relación a las situaciones; aclaración de conceptos dentro de la descripción del tema."></textarea>
                </div>
            </div>
            <hr>

            <div>
                <div id="situaciones-container" class="row">
                    <button type="button" class="btn btn-success" id="addSituacionBtn">Agregar otra descripción de situaciones</button>
                    <div class="situacion-group col-md-6 mb-4">
                        <h6>Descripción de Situaciones de la Práctica</h6>
                        <button type="button" class="btn btn-danger btn-sm btn-eliminar-situacion" onclick="removeSituacion(this)">X</button>
                        <textarea class="form-control mb-2" rows="3" placeholder="Son elementos que facilitan la descripción del tema, por ejemplo: Datos estadísticos; descripción del lugar, la escena, las situaciones, datos específicos con relación a las situaciones; aclaración de conceptos dentro de la descripción del tema."></textarea>
                        <h6>Problemas</h6>
                        <div id="problemas-container" class="problemas-container">
                            <div class="problem-group"></div>
                        </div>
                        <div class="controls">
                            <button type="button" class="btn btn-success btn-sm" onclick="addProblem(this)">Agregar más problemas</button>
                        </div>
                        <hr>
                        <!-- Lista desplegable de problemas locales -->
                        <h6>Lista de Problemas de Esta Situación</h6>
                        <select class="form-select lista-problemas-locales" required>
                            <option selected disabled value="">Selecciona un problema</option>
                        </select>
                    </div>
                </div>
            </div>
            <hr>

            <button type="button" class="btn btn-primary" id="nextBtn">Siguiente</button>
        </div>
        <!-- Sección Fase y Problemas -->
        <div id="faseSection">
            <hr>
            <h4>PLANO DE LA CONTEXTUALIZACIÓN</h4>
            <div class="row header-row">
                <div class="col">Problemas Redactados</div>
                <div class="col">Fase</div>
                <div class="col">Campos Formativos</div>
                <div class="col">Contenidos</div>
                <div class="col">PDA</div>
                <div class="col">Eje Articulador</div>
                <div class="col">Objeto de Enseñanza</div>
                <div class="col">Nivel de Logro</div>
                <div class="col">Evidencia de Aprendizaje</div>
                <div class="col">Eliminar</div>
            </div>

            <div id="matrix-container">
                <div class="row-matrix">
                    <div class="col">
                        <select class="form-select" id="problemasSelect">
                            <option selected disabled value="">Selecciona un problema</option>
                        </select>
                    </div>
                    <div class="col">
                        <select class="form-select" id="faseSelect">
                            <option selected disabled value="">Fase</option>
                            <option value="fase1">Fase 1</option>
                            <option value="fase2">Fase 2</option>
                            <option value="fase3">Fase 3</option>
                        </select>
                    </div>
                    <div class="col">
                        <select class="form-select" id="camposFormativosSelect">
                            <option selected disabled value="">Selecciona un campo formativo</option>
                            <option value="campo1">Campo Formativo 1</option>
                            <option value="campo2">Campo Formativo 2</option>
                        </select>
                    </div>
                    <div class="col">
                        <select class="form-select" id="contenidosSelect">
                            <option selected disabled value="">Selecciona un contenido</option>
                        </select>
                    </div>
                    <div class="col">
                        <select class="form-select" id="pdaSelect">
                            <option selected disabled value="">Selecciona un PDA</option>
                        </select>
                    </div>
                    <div class="col">
                        <select class="form-select">
                            <option selected disabled value="">Selecciona un eje articulador</option>
                            <option value="eje1">Eje 1</option>
                            <option value="eje2">Eje 2</option>
                        </select>
                    </div>
                    <div class="col">
                        <select class="form-select">
                            <option selected disabled value="">Selecciona un objeto de enseñanza</option>
                            <option value="objeto1">Objeto 1</option>
                            <option value="objeto2">Objeto 2</option>
                        </select>
                    </div>
                    <div class="col">
                        <select class="form-select">
                            <option selected disabled value="">Selecciona un nivel de logro</option>
                            <option value="nivel1">Nivel 1</option>
                            <option value="nivel2">Nivel 2</option>
                        </select>
                    </div>
                    <div class="col">
                        <textarea class="form-control textarea-evidencia" placeholder="Evidencia de Aprendizaje"></textarea>
                    </div>
                    <div class="col">
                        <button type="button" class="btn btn-danger remove-row-btn">-</button>
                    </div>
                </div>
            </div>
            <button type="button" class="btn btn-success add-row-btn" id="addRowBtn">+</button>

            <button type="button" class="btn btn-secondary" id="previousBtn">Anterior</button>
        </div>
    </div>


    <footer>
        <p>Pie de página amplio para facilitar la navegación.</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('addSituacionBtn').addEventListener('click', function () {
            const container = document.getElementById('situaciones-container');
            const newSituacion = document.createElement('div');
            newSituacion.classList.add('situacion-group', 'col-md-6', 'mb-4');
            newSituacion.innerHTML = `
                <h6>Descripción de Situaciones de la Práctica</h6>
                <button type="button" class="btn btn-danger btn-sm btn-eliminar-situacion" onclick="removeSituacion(this)">X</button>
                <textarea class="form-control mb-2" rows="3" placeholder="Son elementos que facilitan la descripción del tema, por ejemplo: Datos estadísticos; descripción del lugar, la escena, las situaciones, datos específicos con relación a las situaciones; aclaración de conceptos dentro de la descripción del tema."></textarea>
                <h6>Problemas</h6>
                <div id="problemas-container" class="problemas-container">
                    <div class="problem-group"></div>
                </div>
                <div class="controls">
                    <button type="button" class="btn btn-success btn-sm" onclick="addProblem(this)">Agregar más problemas</button>
                </div>
                <hr>
                <h6>Lista de Problemas de Esta Situación</h6>
                <select class="form-select lista-problemas-locales" required>
                    <option selected disabled value="">Selecciona un problema</option>
                </select>
            `;
            container.appendChild(newSituacion);
        });

        function updateContenidos() {
            const fase = document.getElementById('faseSelect').value;
            const campoFormativo = document.getElementById('camposFormativosSelect').value;
            const contenidosSelect = document.getElementById('contenidosSelect');
            
            // Limpiar contenidos anteriores
            contenidosSelect.innerHTML = '<option selected disabled value="">Selecciona un contenido</option>';
            
            // Aquí puedes modificar el contenido según fase y campo formativo
            if (fase === 'fase1' && campoFormativo === 'campo1') {
                contenidosSelect.innerHTML += '<option value="contenido1">Contenido 1</option>';
            } else if (fase === 'fase2' && campoFormativo === 'campo2') {
                contenidosSelect.innerHTML += '<option value="contenido2">Contenido 2</option>';
            }
        }

        function updatePDA() {
            const contenido = document.getElementById('contenidosSelect').value;
            const pdaSelect = document.getElementById('pdaSelect');
            
            // Limpiar PDA anteriores
            pdaSelect.innerHTML = '<option selected disabled value="">Selecciona un PDA</option>';
            
            // Aquí puedes modificar el contenido del PDA según el contenido seleccionado
            if (contenido === 'contenido1') {
                pdaSelect.innerHTML += '<option value="pda1">PDA 1</option>';
            } else if (contenido === 'contenido2') {
                pdaSelect.innerHTML += '<option value="pda2">PDA 2</option>';
            }
        }

        function addProblem(button) {
            const problemasContainer = button.closest('.situacion-group').querySelector('.problemas-container');
            const problemGroup = document.createElement('div');
            problemGroup.classList.add('problem-group');
            problemGroup.innerHTML = `
                <textarea class="form-control mb-2" rows="2" placeholder="Escribir los problemas resultantes de la problematización anterior.  Ordenar esos problemas con algún criterio: histórico, genealógico, menor a mayor profundidad."></textarea>
                <button type="button" class="btn btn-danger btn-sm mb-2" onclick="removeProblem(this)">Eliminar problema</button>
            `;
            problemasContainer.appendChild(problemGroup);

            const textarea = problemGroup.querySelector('textarea');
            textarea.addEventListener('blur', function () {
                if (textarea.value !== "") {
                    addToLocalDropdown(button, textarea.value);
                }
            });
        }

        function removeProblem(button) {
            const problemText = button.previousElementSibling.value;
            if (problemText !== "") {
                removeFromDropdown(button, problemText);
            }
            button.parentElement.remove();
        }

        function removeSituacion(button) {
            button.parentElement.remove();
        }

        function addToLocalDropdown(button, problemText) {
            const problemasLista = button.closest('.situacion-group').querySelector('.lista-problemas-locales');
            const option = document.createElement('option');
            option.value = problemText;
            option.text = problemText;
            problemasLista.appendChild(option);
        }

        function removeFromDropdown(button, problemText) {
            const problemasLista = button.closest('.situacion-group').querySelector('.lista-problemas-locales');
            const options = problemasLista.querySelectorAll('option');
            options.forEach(option => {
                if (option.value === problemText) {
                    option.remove();
                }
            });
        }

        document.getElementById('nextBtn').addEventListener('click', function () {
            document.getElementById('mainSection').style.display = 'none';
            document.getElementById('faseSection').style.display = 'block';

            // Pasar problemas a la lista desplegable en la sección de Fase
            const problemas = document.querySelectorAll('.lista-problemas-locales option');
            const problemasSelect = document.getElementById('problemasSelect');
            problemasSelect.innerHTML = '<option selected disabled value="">Selecciona un problema</option>';
            problemas.forEach(problem => {
                const option = document.createElement('option');
                option.value = problem.value;
                option.text = problem.text;
                problemasSelect.appendChild(option);
            });
        });

        document.getElementById('previousBtn').addEventListener('click', function () {
            document.getElementById('faseSection').style.display = 'none';
            document.getElementById('mainSection').style.display = 'block';
        });
        // Agregar nueva fila en la sección de fase
        document.getElementById('addRowBtn').addEventListener('click', function () {
            const matrixContainer = document.getElementById('matrix-container');
            const newRow = document.createElement('div');
            newRow.classList.add('row-matrix');
            newRow.innerHTML = `
                <div class="col">
                    <select class="form-select" id="problemasSelect">
                        <option selected disabled value="">Selecciona un problema</option>
                    </select>
                </div>
                <div class="col">
                    <select class="form-select" id="faseSelect">
                        <option selected disabled value="">Fase</option>
                        <option value="fase1">Fase 1</option>
                        <option value="fase2">Fase 2</option>
                        <option value="fase3">Fase 3</option>
                    </select>
                </div>
                <div class="col">
                    <select class="form-select" id="camposFormativosSelect">
                        <option selected disabled value="">Selecciona un campo formativo</option>
                        <option value="campo1">Campo Formativo 1</option>
                        <option value="campo2">Campo Formativo 2</option>
                    </select>
                </div>
                <div class="col">
                    <select class="form-select" id="contenidosSelect">
                        <option selected disabled value="">Selecciona un contenido</option>
                    </select>
                </div>
                <div class="col">
                    <select class="form-select" id="pdaSelect">
                        <option selected disabled value="">Selecciona un PDA</option>
                    </select>
                </div>
                <div class="col">
                    <select class="form-select">
                        <option selected disabled value="">Selecciona un eje articulador</option>
                        <option value="eje1">Eje 1</option>
                        <option value="eje2">Eje 2</option>
                    </select>
                </div>
                <div class="col">
                    <select class="form-select">
                        <option selected disabled value="">Selecciona un objeto de enseñanza</option>
                        <option value="objeto1">Objeto 1</option>
                        <option value="objeto2">Objeto 2</option>
                    </select>
                </div>
                <div class="col">
                    <select class="form-select">
                        <option selected disabled value="">Selecciona un nivel de logro</option>
                        <option value="nivel1">Nivel 1</option>
                        <option value="nivel2">Nivel 2</option>
                    </select>
                </div>
                <div class="col">
                    <textarea class="form-control textarea-evidencia" placeholder="Evidencia de Aprendizaje"></textarea>
                </div>
                <div class="col">
                    <button type="button" class="btn btn-danger remove-row-btn">-</button>
                </div>
            `;
            matrixContainer.appendChild(newRow);

            // Añadir funcionalidad para eliminar fila
            newRow.querySelector('.remove-row-btn').addEventListener('click', function () {
                newRow.remove();
            });
        });

        // Añadir funcionalidad para eliminar la fila existente
        document.querySelectorAll('.remove-row-btn').forEach(function (button) {
            button.addEventListener('click', function () {
                button.closest('.row-matrix').remove();
            });
        });
    </script>
</body>
</html>
